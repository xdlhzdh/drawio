<mxfile host="app.diagrams.net" modified="2022-05-10T13:13:49.234Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36 Edg/100.0.1185.50" etag="iGFWRmcp5e-EboMugMJy" version="18.0.1" type="github">
  <diagram id="I7b-DVMGUag0UUCmyViW" name="Page-1">
    <mxGraphModel dx="1422" dy="905" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-1" value="1. 构造如上两个channel&amp;nbsp; repo&lt;br&gt;2. 如果上面的&lt;b&gt;pal &lt;/b&gt;channel block跟下面的channel block不一样，relinquish上面的channel对应的cell&lt;br&gt;3. 如果下面的&lt;b&gt;pal &lt;/b&gt;channel block跟上面的channel block不一样，relinquish上面的channel对应的cell&lt;br&gt;4. 如果下面的&lt;b&gt;pal &lt;/b&gt;channel block &lt;b&gt;cell&lt;/b&gt;对应的原先assigned的channel block不存在，则走first grant；如果存在且没有被relinquish且被新的selected的channel block占用，则relinquish原先assigned的channel block&lt;br&gt;5. 如果下面的&lt;b&gt;all &lt;/b&gt;channel block &lt;b&gt;cell&lt;/b&gt;对应的原先assigned的channel block被relinquished，则走first grant&lt;br&gt;6. 所有需要走first grant的channel block上面的channel block存在, relinquish上面的channel block&lt;br&gt;7. 重复step5-6，直至step6条件不满足，跳至step8；到目前为止，所有的relinquish/first grant都&lt;b&gt;属于pal change&lt;/b&gt;&lt;br&gt;8. 如果下面的&lt;b&gt;pal &lt;/b&gt;channel block &lt;b&gt;cell&lt;/b&gt;对应的原先assigned的channel block存在且没有被relinquish且没有被新的selected的channel block占用，则走second grant，也&lt;b&gt;属于pal change&lt;/b&gt;&lt;br&gt;9.下面的&lt;b&gt;all &lt;/b&gt;channel block &lt;b&gt;cell &lt;/b&gt;剔除掉已经确定需要走first/second grant之后剩下的channel block，如果对应的原先assigned的channel block不存在并且自己的上面没有channel block，则走first grant；如果对应的原先assigned的channel block存在并且其下面没有channel block，同时自己的上面没有channel block，则走second grant。此步骤&lt;b&gt;属于非pal change&lt;/b&gt;&lt;br&gt;9. 如果上面的&lt;b&gt;pal&amp;nbsp;&lt;/b&gt;channel block &lt;b&gt;cell&lt;/b&gt;没有被selected，relinquish此cell，此步骤属于&lt;b&gt;pal change&lt;/b&gt;&lt;br&gt;10. 如果上面的&lt;b&gt;gaa&amp;nbsp;&lt;/b&gt;channel block&amp;nbsp;&lt;b&gt;cell&lt;/b&gt;没有被selected，relinquish此cell，此步骤属于非pal change&lt;br&gt;11. 所有被relinquished但是没有被grant的cell走正常的SI" style="rounded=0;whiteSpace=wrap;html=1;align=left;fontSize=15;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="14" y="270" width="800" height="320" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-2" value="&lt;b&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;Assigned&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(Old)&lt;/span&gt;&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="20" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-3" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell1 3550-3570 GAA&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="100" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-4" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell2 3570-3590 GAA&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="180" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-5" value="" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="260" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-6" value="CellDn&lt;br&gt;Type&lt;br style=&quot;font-size: 13px&quot;&gt;MaxEirp" style="rounded=0;whiteSpace=wrap;html=1;fontSize=13;align=center;fontStyle=0;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="340" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-7" value="" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="420" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-8" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell1 3650-3570 GAA&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="500" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-9" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell2 3670-3590 PAL&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="580" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-10" value="" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="660" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-11" value="&lt;b&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;Selected&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(New)&lt;/span&gt;&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="20" y="190" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-12" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell3 3550-3570 GAA OR&lt;br&gt;Empty&lt;br&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="100" y="190" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-13" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell1: 3570-3590 PAL&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="180" y="190" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-14" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell2: 3590-3610 PAL&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="260" y="190" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-15" value="" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="340" y="190" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-16" value="" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="420" y="190" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-17" value="&lt;font style=&quot;font-size: 12px&quot;&gt;Cell2&amp;nbsp; 3650-3570 PAL&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="500" y="190" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-18" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell1: 3670-3590 GAA OR Empty&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="580" y="190" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-19" value="" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="660" y="190" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-22" value="PAL Usage Upgrade" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontColor=#000000;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="291" y="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-23" value="&lt;font style=&quot;font-size: 15px&quot;&gt;注意：&lt;br&gt;1. 对于要走second grant的Cell需要更新ChannelRepo(updateChannelState)&lt;br&gt;2. 对于要走second grant的Cell需要先stop second，包含ActionQueue中的second action&lt;br&gt;&lt;/font&gt;" style="text;html=1;strokeColor=#b85450;fillColor=#f8cecc;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="20" y="610" width="590" height="80" as="geometry" />
        </mxCell>
        <mxCell id="e3JJVRDGPqxO4OqVIrgf-2" value="&lt;b style=&quot;font-size: 14px;&quot;&gt;SBTS场景下:&lt;/b&gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;br&gt;&lt;u&gt;For LTE:&lt;/u&gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;1. apply LTE pal changes&lt;br style=&quot;font-size: 14px;&quot;&gt;2. send SI for relinquished cell without grant&lt;br style=&quot;font-size: 14px;&quot;&gt;3. for normal upgrade, don&#39;t use pal channel as available channel in spectrum selection&amp;nbsp;&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;u&gt;For NR:&lt;/u&gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;If (NR pal changes != none)&lt;br style=&quot;font-size: 14px;&quot;&gt;{&lt;br style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; apply NR pal changes;&lt;br style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; if (NR gaa changes != none)&lt;br style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; {&lt;br style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; apply NR gaa changes;&lt;br style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;br style=&quot;font-size: 14px;&quot;&gt;}&lt;br style=&quot;font-size: 14px;&quot;&gt;else&lt;br style=&quot;font-size: 14px;&quot;&gt;{&lt;br style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; normal second upgrade(using available pal &amp;amp; gaa channel);&lt;br style=&quot;font-size: 14px;&quot;&gt;}" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="14" y="740" width="566" height="370" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
