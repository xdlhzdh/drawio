<mxfile host="app.diagrams.net" modified="2022-05-25T05:50:20.335Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.64 Safari/537.36 Edg/101.0.1210.47" etag="lD6CuRfYU2PJjHJR2zkz" version="18.0.3" type="github">
  <diagram id="I7b-DVMGUag0UUCmyViW" name="Page-1">
    <mxGraphModel dx="1422" dy="762" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="1654" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-1" value="1. 构造如上两个channel&amp;nbsp; repo&lt;br&gt;2. 如果上面的&lt;b&gt;pal &lt;/b&gt;channel block跟下面的channel block不一样，relinquish上面的channel对应的cell&lt;br&gt;3. 如果下面的&lt;b&gt;pal &lt;/b&gt;channel block跟上面的channel block不一样，relinquish上面的channel对应的cell&lt;br&gt;4. 如果下面的&lt;b&gt;pal &lt;/b&gt;channel block &lt;b&gt;cell&lt;/b&gt;对应的原先assigned的channel block不存在，则走first grant；如果存在且没有被relinquish且被新的selected的channel block占用，则relinquish原先assigned的channel block&lt;br&gt;5. 如果下面的&lt;b&gt;all &lt;/b&gt;channel block &lt;b&gt;cell&lt;/b&gt;对应的原先assigned的channel block被relinquished，则走first grant&lt;br&gt;6. 所有需要走first grant的channel block上面的channel block存在, relinquish上面的channel block&lt;br&gt;7. 重复step5-6，直至step6条件不满足，跳至step8；到目前为止，所有的relinquish/first grant都&lt;b&gt;属于pal change&lt;/b&gt;&lt;br&gt;8. 如果下面的&lt;b&gt;pal &lt;/b&gt;channel block &lt;b&gt;cell&lt;/b&gt;对应的原先assigned的channel block存在且没有被relinquish且没有被新的selected的channel block占用，则走second grant，也&lt;b&gt;属于pal change&lt;/b&gt;&lt;br&gt;9.下面的&lt;b&gt;all &lt;/b&gt;channel block &lt;b&gt;cell &lt;/b&gt;剔除掉已经确定需要走first/second grant之后剩下的channel block，如果对应的原先assigned的channel block不存在并且自己的上面没有channel block，则走first grant；如果对应的原先assigned的channel block存在并且其下面没有channel block，同时自己的上面没有channel block，则走second grant。此步骤&lt;b&gt;属于gaa change&lt;/b&gt;&lt;br&gt;10. 如果上面的&lt;b&gt;all&amp;nbsp;&lt;/b&gt;channel block &lt;b&gt;cell&lt;/b&gt;没有被selected，要么是因为此channel block最新的SI channel质量变差（其它质量更好），要么是因为被更高优先级的cell占用，总之需要relinquish此cell，可以视为&lt;b&gt;pal change&lt;/b&gt;&lt;br&gt;11. 所有被relinquished但是没有被grant的cell走正常的SI" style="rounded=0;whiteSpace=wrap;html=1;align=left;fontSize=15;fillColor=#ffe6cc;strokeColor=#d79b00;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="7" y="190" width="814" height="310" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-2" value="&lt;b&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;Assigned&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(Old)&lt;/span&gt;&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="7" y="50" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-3" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell1 3550-3570 GAA&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="87" y="50" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-4" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell2 3570-3590 GAA&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="167" y="50" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-5" value="" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="247" y="50" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-6" value="CellDn&lt;br&gt;Type&lt;br style=&quot;font-size: 13px&quot;&gt;MaxEirp" style="rounded=0;whiteSpace=wrap;html=1;fontSize=13;align=center;fontStyle=0;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="327" y="50" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-7" value="" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="407" y="50" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-8" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell1 3650-3570 GAA&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="487" y="50" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-9" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell2 3670-3590 PAL&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="567" y="50" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-10" value="" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="647" y="50" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-11" value="&lt;b&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;Selected&lt;/span&gt;&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;font-size: 13px;&quot;&gt;(New)&lt;/span&gt;&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="7" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-12" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell3 3550-3570 GAA OR&lt;br&gt;Empty&lt;br&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="87" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-13" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell1: 3570-3590 PAL&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="167" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-14" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell2: 3590-3610 PAL&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="247" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-15" value="" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="327" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-16" value="" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="407" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-17" value="&lt;font style=&quot;font-size: 12px&quot;&gt;Cell2&amp;nbsp; 3650-3570 PAL&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="487" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-18" value="&lt;span style=&quot;font-size: 12px&quot;&gt;Cell1: 3670-3590 GAA OR Empty&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="567" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-19" value="" style="rounded=0;whiteSpace=wrap;html=1;fontSize=15;align=center;verticalAlign=middle;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="647" y="120" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-22" value="PAL Usage Upgrade" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontColor=#000000;fontStyle=1;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="292" y="10" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="0SPUhZUTOxkxkWTP6AR3-23" value="&lt;font style=&quot;font-size: 15px&quot;&gt;注意：&lt;br&gt;1. 对于要走second grant的Cell需要更新ChannelRepo(updateChannelState)&lt;br&gt;2. 对于要走second grant的Cell需要先stop second，包含ActionQueue中的second action&lt;br&gt;&lt;/font&gt;" style="text;html=1;strokeColor=#b85450;fillColor=#f8cecc;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=14;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="7" y="510" width="590" height="80" as="geometry" />
        </mxCell>
        <mxCell id="e3JJVRDGPqxO4OqVIrgf-2" value="&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;b style=&quot;&quot;&gt;SBTS场景下:&lt;br&gt;&lt;/b&gt;&lt;br&gt;&lt;u&gt;Preemption timer trigger condition:&lt;/u&gt;&lt;br&gt;NR para || NR register change(deregister -&amp;gt; register) || LTE para || LTE register change(deregister -&amp;gt; register)&lt;br&gt;&lt;br&gt;&lt;u&gt;preemption re-calculation condition:&lt;/u&gt;&lt;br&gt;SBTS &amp;amp;&amp;amp; NR CBSD registered &amp;amp;&amp;amp; NR feature on &amp;amp;&amp;amp; LTE CBSD registered &amp;amp;&amp;amp; LTE feature on &amp;amp;&amp;amp; at least one PAL is configured&lt;br style=&quot;&quot;&gt;&lt;br&gt;&lt;u style=&quot;&quot;&gt;For LTE:&lt;/u&gt;&lt;br style=&quot;&quot;&gt;1. apply LTE pal changes&lt;br style=&quot;&quot;&gt;2. send SI for relinquished cell without first/second grant&lt;br style=&quot;&quot;&gt;3. for normal upgrade, exclude pal channel from available channel in spectrum selection&amp;nbsp;&lt;br style=&quot;&quot;&gt;&lt;br style=&quot;&quot;&gt;&lt;u style=&quot;&quot;&gt;For NR:&lt;/u&gt;&lt;/font&gt;&lt;br style=&quot;&quot;&gt;If (NR pal changes != none)&lt;br style=&quot;&quot;&gt;{&lt;br style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; apply NR pal changes;&lt;br&gt;&amp;nbsp; &amp;nbsp; // To avoid Ping-Pong with normal upgrade, apply the&amp;nbsp;NR gaa changes&lt;br style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; if (NR gaa changes != none)&lt;br style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; {&lt;br style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; apply NR gaa changes; // try to upgrade, not including all better options because&amp;nbsp;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // gaa upgrade in re-cal can&#39;t relinquish but occupied one option&lt;br style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;br style=&quot;&quot;&gt;}&lt;br style=&quot;&quot;&gt;else&lt;br style=&quot;&quot;&gt;{&lt;br style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; normal second upgrade(using available pal &amp;amp; gaa channel);&lt;br style=&quot;&quot;&gt;}&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=14;fontFamily=Helvetica;labelBorderColor=default;labelBackgroundColor=none;sketch=0;shadow=0;glass=0;" parent="1" vertex="1">
          <mxGeometry x="5.5" y="589" width="593" height="580" as="geometry" />
        </mxCell>
        <mxCell id="syBKgrgxoMQ6-uX4aRrQ-3" value="&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;i style=&quot;&quot;&gt;&lt;b style=&quot;&quot;&gt;SasQueryTimer &amp;amp; PreemptionTimer:&lt;/b&gt;&lt;/i&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;SbtsPalUpgradeTimerId独立于NormalUpgradeTimerId&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;u&gt;In HB callback&lt;/u&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;if (NON-SBTS &amp;amp;&amp;amp; SasQueryPeriod &amp;gt; 0)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;{&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; start SasQueryTimer for normal upgrade&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;}&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;QuerySasServerPeriodSubscribe remove!!!&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;u&gt;When startup or parameters changed&lt;/u&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;if (SBTS &amp;amp;&amp;amp; NRCBSD registered &amp;amp;&amp;amp;&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; NR feature on &amp;amp;&amp;amp; LTE CBSD registered &amp;amp;&amp;amp; LTE feature on &amp;amp;&amp;amp;&lt;br&gt;&amp;nbsp; &amp;nbsp; at least one PAL is configured&lt;span style=&quot;background-color: initial;&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;{&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; if (PreemptionTimer(5min) &amp;gt;= SasQueryTimer &amp;amp;&amp;amp; SasQueryPeriod&amp;nbsp;&amp;gt; 0)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (SasQueryTimer(SbtsPALUpgradeTimerId) not started)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; start SasQueryTimer for PAL upgrade&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; start PreemptionTimer for PAL upgrade&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;}&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;u&gt;In PreemptionTimer timeout handler&lt;/u&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;if (SBTS &amp;amp;&amp;amp; NRCBSD registered &amp;amp;&amp;amp;&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; NR feature on &amp;amp;&amp;amp; LTE CBSD registered &amp;amp;&amp;amp; LTE feature on &amp;amp;&amp;amp;&lt;br&gt;&amp;nbsp; &amp;nbsp; at least one PAL is configured&lt;span style=&quot;background-color: initial;&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;{&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; PAL upgrade for SBTS&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; start SasQueryTimer for PAL upgrade&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;i&gt;(timerPeriod = max(SasQueryPeriod, 1min))&lt;/i&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;}&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;u&gt;In SasQueryTimer handler&lt;/u&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px;&quot;&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;if (not (NRCBSD registered &amp;amp;&amp;amp; NR feature on))&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; return;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;start SasQueryTimer for PAL upgrade&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;i style=&quot;&quot;&gt;(timerPeriod = max(SasQueryPeriod, 1min))&lt;/i&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;if (106 raised || measurement report not exist ||&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;SasQueryPeriod &amp;lt;= 0)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; return;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;if ( SBTS &amp;amp;&amp;amp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;LTE CBSD registered &amp;amp;&amp;amp; LTE feature on &amp;amp;&amp;amp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at least one PAL is configured)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;{&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;PAL upgrade for SBTS&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;}&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;else if (NR is PAL)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;{&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;PAL upgrade for NR&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;}&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;else&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;{&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;NR normal upgrade&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;}&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;sketch=0;shadow=0;labelBorderColor=default;" vertex="1" parent="1">
          <mxGeometry x="610" y="510" width="500" height="1100" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
